# WebNote
笔记

## 19.7.24  
### 浏览器渲染流程  
1.处理HTML并构建DOM树  
2.处理CSS构建CSSOM树  
3.将DOM与CSSOM合并成一个渲染树  
4.根据渲染树来布局,计算每个节点的位置  
5.调用GPU绘制,合并图层,显示在屏幕上  
   
### 阻塞渲染  
在构建CSSOM树时，会阻塞渲染，直到CSSOM树构建完毕。  
当HTML解析到script标签时，会暂停构建DOM，直到解析完后才会在暂停的地方重新开始。  
并且CSS也会影响JS的执行，只有解析完样式表才会去执行JS，所以也可以认为这种情况下，CSS也会暂停构建DOM。  

head内的js脚本会阻塞body标签的渲染，把js脚本放在head内需要等到js执行完毕后才会渲染body。  
而将样式文件写在head中是为了避免页面元素由于样式缺失造成的白屏现象。

https://yuchengkai.cn/docs/frontend/browser.html#%E6%B8%B2%E6%9F%93%E6%9C%BA%E5%88%B6

## 19.7.26
### 浏览器事件循环 冒泡与绑定
JS中有一个主线程和调用栈，所有的任务都会放入到调用栈里面等待主线程执行。  
调用栈：后进先出，当函数被调用时，会被添加到栈中的顶部，执行完毕后从顶部移除这个函数，直到调用栈被清空。   
任务队列：先进先出，如果是同步函数则会在调用栈中按顺序被主线程调用，如果时异步函数则会在异步有了结果之后，将注册的回调函数放入到任务队列中，等到调用栈被清空了，也就是主线程空闲的时候，被读取到调用栈中等待执行。   

宏任务：包括整体代码script，setTimeout,setInterval等
微任务：Promise，process.nextTick等
进入整体代码（宏任务）后，开始第一次循环，执行所有的微任务。接着再次从宏任务开始，找到其中一个宏任务队列执行完毕，再执行所有微任务。以此循环。

**调用栈中的同步任务都执行完毕了，栈内就清空了，代表主线程空闲了，就会去任务队列按顺序读取一个任务放入栈中执行。每次栈内被清空，就会去读取任务队列还有没有任务，有就读取执行，一直循环读取-执行的操作，这就形成了事件循环。**

https://juejin.im/post/59e85eebf265da430d571f89
https://www.cnblogs.com/yqx0605xi/p/9267827.html
